x = [2.0000000000; 2.0625000000; 2.1250000000; 2.1875000000; 2.2500000000; 2.3125000000; 2.3750000000; 2.4375000000; 2.5000000000; 2.5625000000; 2.6250000000; 2.6875000000; 2.7500000000; 2.8125000000; 2.8750000000; 2.9375000000; 3.0000000000; 3.0625000000; 3.1250000000; 3.1875000000; 3.2500000000; 3.3125000000; 3.3750000000; 3.4375000000; 3.5000000000; 3.5625000000; 3.6250000000; 3.6875000000; 3.7500000000; 3.8125000000; 3.8750000000; 3.9375000000; 4.0000000000];

y = poly(x);

y3 = [7.1850398633; 7.1096858388; 7.0986919306; 7.1427827904; 7.2337297958; 7.3642890342; 7.5281392850; 7.7198200037; 7.9346693045; 8.1687619441; 8.4188473041; 8.6822873751; 8.9569947392; 9.2413705536; 9.5342425338; 9.8348029365; 10.1425465431; 10.4572086429; 10.7787030162; 11.1070599175; 11.4423640587; 11.7846925927; 12.1340530958; 12.4903215516; 12.8531803341; 13.2220561907; 13.5960582253; 13.9739158822; 14.3539169283; 14.7338454372; 15.1109197719; 15.4817305681; 15.8421787177];
y5 = [7.1850398633; 7.1196176606; 7.1286116996; 7.1928539693; 7.2990123346; 7.4379021822; 7.6032196454; 7.7906132638; 7.9970222972; 8.2202204672; 8.4585136466; 8.7105489575; 8.9752008708; 9.2515072279; 9.5386346208; 9.8358582829; 10.1425465431; 10.4581439962; 10.7821508327; 11.1140982520; 11.4535215636; 11.7999334453; 12.1527998934; 12.5115206522; 12.8754143598; 13.2437062862; 13.6155133747; 13.9898173252; 14.3654116730; 14.7408032358; 15.1140419010; 15.4824455262; 15.8421787177];
y9 = [7.1850398633; 7.1210348801; 7.1313777335; 7.1957031106; 7.3011276162; 7.4390987818; 7.6037037631; 7.7907150083; 7.9970222972; 8.2202786319; 8.4586712348; 8.7107689780; 8.9754178945; 9.2516676289; 9.5387182386; 9.8358806705; 10.1425465431; 10.4581642399; 10.7822191709; 11.1142166236; 11.4536659745; 11.8000651952; 12.1528845943; 12.5115486222; 12.8754143598; 13.2437449462; 13.6156755139; 13.9901679818; 14.3659491489; 14.7414238503; 15.1145509252; 15.4826616374; 15.8421787177];

nodeX3 = [2.0; 3.0; 4.0];
nodeX5 = [2.0; 2.5; 3.0; 3.5; 4.0];
nodeX9 = [2.0; 2.25; 2.5; 2.75; 3.0; 3.25; 3.5; 3.75; 4.0];

nodeY3 = [7.1850398633; 10.1425465431; 15.8421787177];
nodeY5 = [7.1850398633; 7.9970222972; 10.1425465431; 12.8754143598; 15.8421787177];
nodeY9 = [7.1850398633; 7.3011276162; 7.9970222972; 8.9754178945; 10.1425465431; 11.4536659745; 12.8754143598; 14.3659491489; 15.8421787177];

error3 = [0.0000000001; 0.0113602924; 0.0326924934; 0.0529214715; 0.0673978204; 0.0748099413; 0.0755646622; 0.0708950523; 0.0623529927; 0.0515167038; 0.0398239514; 0.0284816100; 0.0184231553; 0.0102970793; 0.0044757116; 0.0010777370; 0.0000000001; 0.0009555997; 0.0035161603; 0.0071567092; 0.0113019157; 0.0153726071; 0.0188315105; 0.0212270790; 0.0222340257; 0.0216887758; 0.0196173587; 0.0162521654; 0.0120322206; 0.0075787178; 0.0036326935; 0.0009332937; 0.0000000001];
error5 = [0.0000000001; 0.0014284706; 0.0027727244; 0.0028502925; 0.0021152817; 0.0011967933; 0.0004843018; 0.0001017921; 0.0000000001; 0.0000581807; 0.0001576089; 0.0002200276; 0.0002170237; 0.0001604051; 0.0000836246; 0.0000223905; 0.0000000001; 0.0000202464; 0.0000683438; 0.0001183747; 0.0001444109; 0.0001317544; 0.0000847129; 0.0000279784; 0.0000000001; 0.0000386803; 0.0001622093; 0.0003507224; 0.0005374759; 0.0006209191; 0.0005105644; 0.0002183356; 0.0000000001];
error9 = [0.0000000001; 0.0000112512; 0.0000066905; 0.0000011512; 0.0000000001; 0.0000001936; 0.0000001840; 0.0000000476; 0.0000000001; 0.0000000160; 0.0000000207; 0.0000000071; 0.0000000001; 0.0000000041; 0.0000000068; 0.0000000030; 0.0000000001; 0.0000000027; 0.0000000056; 0.0000000031; 0.0000000001; 0.0000000045; 0.0000000119; 0.0000000084; 0.0000000001; 0.0000000202; 0.0000000702; 0.0000000658; 0.0000000001; 0.0000003047; 0.0000015402; 0.0000022244; 0.0000000001];

figure;

subplot(2,2,1);
plot(x, y3);
hold on;
plot(x, y);
plot(nodeX3, nodeY3, 'g*', 'MarkerSize', 7);
grid on;
xlabel('X-Value');
ylabel('Y-Value');
title('F(X)');
legend('F(X) - 3 nodes');

subplot(2,2,2);
plot(x, y5);
hold on;
plot(x, y);
plot(nodeX5, nodeY5, 'g*', 'MarkerSize', 7);
grid on;
xlabel('X-Value');
ylabel('Y-Value');
title('F(X)');
legend('F(X) - 5 nodes');

subplot(2,2,3);
plot(x, y9);
hold on;
plot(x, y);
plot(nodeX9, nodeY9, 'g*', 'MarkerSize', 7);
grid on;
xlabel('X-Value');
ylabel('Y-Value');
title('F(X)');
legend('F(X) - 9 nodes');

subplot(2,2,4);
semilogy(x, error3, 'LineWidth', 1.5);
hold on;
semilogy(x, error5, 'LineWidth', 1.5);
semilogy(x, error9, 'LineWidth', 1.5);
theorError = [0.0000000001; 0.0378417969; 0.0683593750; 0.0920410156; 0.1093750000; 0.1208496094; 0.1269531250; 0.1281738281; 0.1250000000; 0.1179199219; 0.1074218750; 0.0939941406; 0.0781250000; 0.0603027344; 0.0410156250; 0.0207519531; 0.0000000001; 0.0207519531; 0.0410156250; 0.0603027344; 0.0781250000; 0.0939941406; 0.1074218750; 0.1179199219; 0.1250000000; 0.1281738281; 0.1269531250; 0.1208496094; 0.1093750000; 0.0920410156; 0.0683593750; 0.0378417969; 0.0000000001];
semilogy(x, theorError, 'LineWidth', 1.5);
grid on;
xlabel('X-Value');
ylabel('ERror-Value');
title('H(X)- F(X)');
legend('3 nodes','5 nodes', '9 nodes');

% figure;
% 
% MaxErrorX3 = [2.0; 3.0; 3.0; 4.0];
% MaxErrorY3 = [0.0755646622; 0.0755646622; 0.0222340257; 0.0222340257];
% semilogy(MaxErrorX3, MaxErrorY3);
% hold on;
% grid on;
% 
% MaxErrorX5 = [2.0; 2.5; 2.5; 3.0; 3.0; 3.5; 3.5; 4.0];
% MaxErrorY5 = [0.0028502925; 0.0028502925; 0.0002200276; 0.0002200276; 0.0001444109; 0.0001444109; 0.0006209191; 0.0006209191];
% semilogy(MaxErrorX5, MaxErrorY5);
% 
% MaxErrorX9 = [2.0; 2.25; 2.25; 2.5; 2.5; 2.75; 2.75; 3.0; 3.0; 3.25; 3.25; 3.5; 3.5; 3.75; 3.75; 4.0];
% MaxErrorY9 = [0.0000112512; 0.0000112512; 0.0000001936; 0.0000001936; 0.0000000207; 0.0000000207; 0.0000000068; 0.0000000068; 0.0000000056; 0.0000000056; 0.0000000119; 0.0000000119; 0.0000000702; 0.0000000702; 0.0000022244; 0.0000022244];
% semilogy(MaxErrorX9, MaxErrorY9);
% 
% xlabel('X-Value');
% ylabel('Error-Value');
% title('MaxError');
% legend('3 nodes','5 nodes', '9 nodes');

figure;
maxX = [1; 2; 3; 4; 5; 6; 7; 8; 9; 10; 11; 12; 13; 14; 15; 16; 17; 18; 19; 20; 21; 22; 23; 24; 25; 26; 27; 28; 29; 30; 31; 32; 33; 34; 35; 36; 37; 38; 39; 40; 41; 42; 43; 44; 45; 46; 47; 48; 49];
maxY = [0.5658738813; 0.0755646622; 0.0136252685; 0.0028502925; 0.0006867652; 0.0001571636; 0.0000398432; 0.0000112512; 0.0000030954; 0.0000008323; 0.0000002192; 0.0000000566; 0.0000000144; 0.0000000035; 0.0000000009; 0.0000000008; 0.0000000020; 0.0000000042; 0.0000000171; 0.0000000622; 0.0000002665; 0.0000008707; 0.0000012541; 0.0000027183; 0.0000140324; 0.0000021355; 0.0000417923; 0.0001209513; 0.0001197140; 0.0000469307; 0.0001724049; 0.0002324049; 0.0004757479; 0.0172540126; 0.0195033082; 0.4263286704; 0.9363628422; 5.1361023923; 39.7606220322; 83.4571138924; 1146.2420604496; 1303.8959481195; 7104.8253222596; 31949.7223872740; 76425.4731539836; 82135.2834850362; 249401.5417678278; 1047329.3386471982; 3385933.9214842157];
semilogy(maxX, maxY, 'LineWidth', 2);
hold on;
grid on;

xlabel('Node-Value');
ylabel('Error-Value');
title('MaxError');
